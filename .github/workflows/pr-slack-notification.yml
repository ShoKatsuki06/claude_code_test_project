name: Pull Request Slack Notification

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  notify-slack:
    runs-on: ubuntu-latest
    
    steps:
      - name: Send Slack notification
        uses: rtCamp/action-slack-notify@v2
        env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK_URL }}
          SLACK_CHANNEL: 'claude_code_notification'
          SLACK_COLOR: ${{ github.event.action == 'opened' && 'good' || 'warning' }}
          SLACK_MESSAGE: |
            ${{ github.event.action == 'opened' && '🔔 新しいプルリクエストが作成されました' || '📝 プルリクエストが更新されました' }}
            
            **リポジトリ:** ${{ github.repository }}
            **作成者:** ${{ github.event.pull_request.user.login }}
            **プルリクエスト:** ${{ github.event.pull_request.title }}
            **ブランチ:** ${{ github.event.pull_request.head.ref }} → ${{ github.event.pull_request.base.ref }}
            **URL:** ${{ github.event.pull_request.html_url }}
          SLACK_TITLE: "Pull Request ${{ github.event.action == 'opened' && 'Created' || 'Updated' }}"
          SLACK_USERNAME: 'GitHub Actions'
          SLACK_FOOTER: 'Powered by GitHub Actions'